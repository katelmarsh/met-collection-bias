# [Model 2]

Going forward, we are going to use the randomly sampled 100,000 art pieces in order to make this project less computationally heavy. 

```{r}
df <- read.csv("met_data_sample_100k")

table(df$Is.Highlight)

table(df$Is.Public.Domain)

```


Actually no! Here is a cleaned and manageable dataset. 
```{r}

df <- read.csv("~/Downloads/MetObjects_Cleaned_Small.csv")
```



```{r}
library(rpart)
library(rpart.plot)

n <- nrow(df)

train <- sample(n, .8*n)
train_dat <- df[train, ]
test_dat <- df[-train, ]

fit <- rpart(is.highlight~., data = train_dat, method = 'class', control = rpart.control(cp = 0))
summary(fit)
plotcp(fit)


#test_dat$pred <- predict(fit, test_dat, type = "class")
#accuracy <- mean(test_dat$pred == test_dat$ss.highlight)


#rpart.plot(fit, extra = 101) 


```
Prune to .18 ! 


```{r}
library(ggplot2)
library(waffle)

culture <- head(sort(table(df$Culture), decreasing = TRUE), 8) # the culture section could clearly use some cleaning! japan and japanese haha 

department <- head(sort(table(df$department), decreasing = TRUE), 8)

River <- head(sort(table(df$River), decreasing = TRUE), 8)

artist.begin.date <- head(sort(table(df$artist.begin.date), decreasing = TRUE), 8)

waffle(River/10, rows=5, size=0.6, 
       title="Art Period", 
       xlab="1 square = 1000 artworks")

waffle(department/10, rows=5, size=0.6, 
       title="Art Department", 
       xlab="1 square = 1000 artworks")

waffle(culture, rows=5, size=0.6, 
       title="Art Culture", 
       xlab="1 square = 1000 artworks")

waffle(period/10, rows=5, size=0.6, 
       title="Art Period", 
       xlab="1 square = 1000 artworks")

waffle(department/10, rows=5, size=0.6, 
       title="Art Department", 
       xlab="1 square = 1000 artworks")

waffle(artist.begin.date/10, rows=5, size=0.6, 
       title="Art Culture", 
       xlab="1 square = 1000 artworks")
```

```{r}
#predict_unseen <-predict(fit, test_dat, type = 'class')
#table_mat <- table(test_dat$Is.Highlight, predict_unseen)

```

```{r}
library(rpart)
library(rpart.plot)


fit <- rpart(is.highlight~is.public.domain + department + country + region + subregion
             + county + state + city + classification, data = train_dat, 
             method = 'class', 
             control = rpart.control(cp = .01))
fit$xlevels[["object.name"]] <- union(fit$xlevels[["object.name"]], levels(test_dat$object.name))

summary(fit)

#test_dat$pred <- predict(fit, test_dat, type = "class")
accuracy <- mean(test_dat$pred == test_dat$is.highlight)


rpart.plot(fit, extra = 106, yesno = 2) 


```

```{r}

split.fun <- function(x, labs, digits, varlen, faclen)
{
    # replace commas with spaces (needed for strwrap)
    labs <- gsub(",", " ", labs)
    for(i in 1:length(labs)) {
        # split labs[i] into multiple lines
        labs[i] <- paste(strwrap(labs[i], width=70), collapse="\n")
    }
    labs
}

rpart.plot::prp(fit,
    split.fun=split.fun,
    type = 2,
    yesno=2,
    clip.right.labs = FALSE,
    extra = 105, 
    under = FALSE, 
    split.cex = 2,
    under.cex = 3, 
    box.palette = "RdYlGn",
    digits = 2,
    fallen.leaves = TRUE, 
    uniform = FALSE,
    #round = 0, 
    #leaf.round= 0, 
    main = "isHighlight Type Decision Tree", 
    #cex.main = 1, 
    branch.col = "gray", 
    branch.lwd = 4, 
    faclen = 8, 
    #facsep = ",  ", 
    compress = TRUE, 
    branch.tweak = 1)
```

The decision tree shows that the model uses classification, department, "is public domain" and subregion of the world to determine whether the artwork is a highlight of the Metropolitan Museum of Art. Interestingly, 34% of the artworks can be excluded as "not highlights" by merely the type of art it is. If something is calligraphy, metalwork, textiles, daggers, glass, or etc., they are unlikely to be important to the Met. This is a unique finding because it shows that historic arts that were more likely to be done by women, such as textiles or basketry, are not highlighted by the Met. In accordance to what we might expect, preliminary or supporting artwork, such as drawings, stencils or photo negatives, are also deemed not a highlight. Also interesting is that then the decision tree uses departments to decide, indicating that Asian Art, Costumes, Drawings, Photographs, and Egyptian Art are less indicative of a Highlight status. Older artworks, as expected, are more likely to be highlights (according to the public domain variable). In the last two decisions, we learn that jewelry, shells, enamels, and some other classifications are unlikely to indicate being a highlight, as well as the fact that certain subregions indicate that the artwork is not highlighted. Upon investigation, these subregions are all parts of Egypt that are less famous for ruins. Compared to another subregion, such as Saqqara, which is an Ancient burial ground. 






