# [Model 5]

neural network <3 

```{r}

library("neuralnet")
library("dplyr")



nn=neuralnet(is.highlightTrue ~., 
             data = train_dat, 
             hidden=3,
             act.fct = "logistic", 
             linear.output = FALSE)

plot(nn,rep = "best")


```


```{r}
pred <- predict(nn, test_dat)
labels <- c("0", "1")
prediction_label <- data.frame(max.col(pred)) %>%     
mutate(pred=labels[max.col.pred.]) %>%
select(2) %>%
unlist()

table(test_dat$is.highlightTrue, prediction_label)
```

It got everything right! I am confused on why there are exactly 744 samples, but I will figure that out later. 


```{r}
check = test_dat$is.highlightTrue == max.col(pred)-1
accuracy = (sum(check)/nrow(test_dat))*100
print(accuracy)
```

Reference: https://cran.r-project.org/web/packages/shapr/vignettes/understanding_shapr.html

```{r}
library(shapr)

explainer <- shapr(train_dat, nn)


```

